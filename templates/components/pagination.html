{% if pagination %}
<nav aria-label="Pagination" class="mt-4">
    <div class="d-flex justify-content-between align-items-center flex-wrap">
        <!-- Pagination info -->
        <div class="pagination-info mb-3 mb-md-0">
            Showing {{ pagination.start_idx }}-{{ pagination.end_idx }} of {{ pagination.total }} {{ items_name|default('items') }}
        </div>
        
        <!-- Pagination controls -->
        <ul class="pagination {{ pagination_size|default('') }}">
            <!-- First page -->
            <li class="page-item {% if pagination.page == 1 %}disabled{% endif %}">
                <a class="page-link" href="{{ url_for(request.endpoint, page=1, **(entity_params | pagination.other_args)) }}" aria-label="First">
                    <span aria-hidden="true">&laquo;&laquo;</span>
                </a>
            </li>
            
            <!-- Previous page -->
            <li class="page-item {% if pagination.page == 1 %}disabled{% endif %}">
                <a class="page-link" href="{{ url_for(request.endpoint, page=pagination.page-1, **(entity_params | pagination.other_args)) }}" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
            
            <!-- Page numbers -->
            {% for p in range(pagination.page_range_start, pagination.page_range_end + 1) %}
                <li class="page-item {% if p == pagination.page %}active{% endif %}">
                    <a class="page-link" href="{{ url_for(request.endpoint, page=p, **(entity_params | pagination.other_args)) }}">{{ p }}</a>
                </li>
            {% endfor %}
            
            <!-- Next page -->
            <li class="page-item {% if pagination.page == pagination.pages %}disabled{% endif %}">
                <a class="page-link" href="{{ url_for(request.endpoint, page=pagination.page+1, **(entity_params | pagination.other_args)) }}" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
            
            <!-- Last page -->
            <li class="page-item {% if pagination.page == pagination.pages %}disabled{% endif %}">
                <a class="page-link" href="{{ url_for(request.endpoint, page=pagination.pages, **(entity_params | pagination.other_args)) }}" aria-label="Last">
                    <span aria-hidden="true">&raquo;&raquo;</span>
                </a>
            </li>
        </ul>
        
        <!-- Per page selector (optional) -->
        {% if show_per_page %}
        <div class="ms-md-auto ps-md-3">
            <form class="d-flex align-items-center" method="GET">
                <label for="per_page" class="me-2 small">Items per page:</label>
                <select id="per_page" name="per_page" class="form-select form-select-sm" style="width: auto;" onchange="this.form.submit()">
                    {% for option in per_page_options|default([10, 20, 50, 100]) %}
                    <option value="{{ option }}" {% if pagination.per_page == option %}selected{% endif %}>{{ option }}</option>
                    {% endfor %}
                </select>
                <!-- Preserve existing query parameters -->
                {% for key, value in request.args.items() if key != 'per_page' %}
                <input type="hidden" name="{{ key }}" value="{{ value }}">
                {% endfor %}
            </form>
        </div>
        {% endif %}
    </div>
</nav>
{% endif %}
